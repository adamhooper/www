<?xml version="1.0"?>
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format" font-family="serif,Symbol,ZapfDingbats" font-size="10pt" text-align="justify" line-height="normal" font-selection-strategy="character-by-character" language="en"><fo:layout-master-set><fo:simple-page-master master-name="blank" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body display-align="center" margin-bottom="0.5in" margin-top="0.5in" region-name="blank-body"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="blank-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="front-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="body-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="back-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in - -4pc" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-first-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:simple-page-master master-name="index-even-draft" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-right="1in" margin-left="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" background-image="url(http://docbook.sourceforge.net/release/images/draft.png)" background-attachment="fixed" background-repeat="no-repeat" background-position-horizontal="center" background-position-vertical="center"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" display-align="after"/></fo:simple-page-master><fo:page-sequence-master master-name="titlepage"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="titlepage-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="lot-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="front-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="body-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="back-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="index-even" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="titlepage-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="titlepage-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="lot-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="front-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="body-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="back-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index-draft"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank-draft" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first-draft" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd-draft" odd-or-even="odd"/><fo:conditional-page-master-reference master-reference="index-even-draft" odd-or-even="even"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master></fo:layout-master-set><fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="1" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>COMP250 Assignment 1</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>COMP250 Assignment 1</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="-4pc"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row height="14pt"><fo:table-cell text-align="left" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body"><fo:block id="id2251996"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block text-align="center"><fo:block keep-with-next="always" font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="8pt" space-before.maximum="12pt" hyphenate="false" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">COMP250 Assignment 1</fo:block></fo:block><fo:block space-before="0.5em" font-size="14.4pt"><fo:block>Adam Hooper <fo:inline font-family="monospace"><fo:inline keep-together.within-line="always" hyphenate="false">&lt;adam.hooper@mail.mcgill.ca&gt;</fo:inline></fo:inline></fo:block></fo:block></fo:block><fo:block/></fo:block></fo:block><fo:block id="toc...id2251996" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" margin-left="-4pc" font-size="17.28pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats">Table of Contents</fo:block></fo:block><fo:block/></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="question-1">Question 1</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="question-1"><fo:page-number-citation ref-id="question-1"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="question-2">Question 2</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="question-2"><fo:page-number-citation ref-id="question-2"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="question-3">Question 3</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="question-3"><fo:page-number-citation ref-id="question-3"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="question-4">Question 4</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="question-4"><fo:page-number-citation ref-id="question-4"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="code">Code</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="code"><fo:page-number-citation ref-id="code"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.id2251996.code" start-indent="24pt"><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="id2449844">basis.java</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="id2449844"><fo:page-number-citation ref-id="id2449844"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="id2449867">q1.java</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="id2449867"><fo:page-number-citation ref-id="id2449867"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="id2449924">q2.java</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="id2449924"><fo:page-number-citation ref-id="id2449924"/></fo:basic-link></fo:inline></fo:block><fo:block text-align-last="justify" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="id2450071">q4.java</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"> <fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" keep-with-next.within-line="always"/> <fo:basic-link internal-destination="id2450071"><fo:page-number-citation ref-id="id2450071"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block><fo:block id="question-1"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">Question 1</fo:marker><fo:block font-size="20.736pt">Question 1</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">This question was relatively simple: instead of trying to modify the given recursive algorithm, it's much easier to go back to the definition of the multiplication, as it was given in class. Keep a running sum; divide <fo:inline font-family="monospace">b</fo:inline> by two every time <fo:inline font-family="monospace">a</fo:inline> is multiplied by two, and add the remainder to the sum all the time. Once <fo:inline font-family="monospace">b</fo:inline> is <fo:inline font-family="monospace">0</fo:inline>, the sum is the answer.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Keeping in mind how binary numbers are stored, there's some farther simplification: Instead of just using integer division and multiplication, use bitshifting instead. Not only is it much faster way of dividing or multiplying by two, but the algorithm works perfectly with both positive and negative numbers.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Below is the program listing.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long mulalarusse (long a, long b)
{
	long result = 0;
																			
	while (b != 0)
	{
		if ((b &amp; 1) == 1)
		{
			result += a;
		}
																			
		a &lt;&lt;= 1;
		b &gt;&gt;&gt;= 1;
	}
																			
	return result;
}</fo:block></fo:block><fo:block id="question-2"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">Question 2</fo:marker><fo:block font-size="20.736pt">Question 2</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">First of all, two <fo:inline font-family="monospace">mulmod</fo:inline> methods must be created: one based on the algorithm given, and another done the most natural way. Call them <fo:inline font-family="monospace">mulmod_java</fo:inline> and <fo:inline font-family="monospace">mulmod</fo:inline>, respectively. The latter is an obvious one-liner, and the former is simply a transcription of the given pseudo-code to Java (though bit-shifting was used instead of division and subtraction/division, for simplicity's sake).</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">I've included a method called <fo:inline font-family="monospace">addmod_java</fo:inline>, which simply returns <fo:inline font-family="monospace">(a + b) % n</fo:inline>. This method will be edited in <fo:basic-link internal-destination="question-3">the section called &#x201C;Question 3&#x201D;</fo:basic-link>.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long addmod_java (long a, long b, long n)
{
	// Return something impossible if Java can't go that high
	if (Long.MAX_VALUE - a - b &lt; 0) return -1;
																			
	return (a + b) % n;
}
																			
public static long mulmod_java (long a, long b, long n)
{
	return (a * b) % n;
}
																			
public static long mulmod (long a, long b, long n)
{
	long a_doubled;
																			
	if (b == 0) return 0; // a * 0 = 0 %n
																			
	a_doubled = addmod_java (a, a, n);
																			
	if (a_doubled &lt; 0) return -1;
																			
	if ((b &amp; 1) == 0)
	{
		return mulmod (a_doubled, b &gt;&gt;&gt; 1, n);
	}
	else
	{
		return addmod_java (a, mulmod (a_doubled, b &gt;&gt;&gt; 1, n), n);
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The question next asks for the largest value of n for which <fo:inline font-family="monospace">mulmod (a, b, n)</fo:inline> is correct, given <fo:inline font-family="monospace">0 &#x2264; a, b &#x2264; n - 1</fo:inline>. Obviously, the most challenging situation is when the largest product possible is reached: in other words, when <fo:inline font-family="monospace">a = b = n - 1</fo:inline>. The problem is that normally, a product which reaches or exceeds <fo:inline font-family="monospace">2<fo:inline font-size="75%" baseline-shift="super">63</fo:inline></fo:inline> would overflow the <fo:inline font-family="monospace">long</fo:inline> data type, losing data. The <fo:inline font-family="monospace">mulmod</fo:inline> algorithm circumvents this to a great extent, but does not remove the possibility altogether.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Perhaps the easiest way to find the largest possible value of <fo:inline font-family="monospace">n</fo:inline> for which the <fo:inline font-family="monospace">mulmod</fo:inline> method works is brute force. When a negative number is returned, there was obviously an overflow; this is how we know whether a given calculation is valid or not. Unfortunately, we can't just write the entire thing in a <fo:inline font-family="monospace">for</fo:inline> loop iterating from <fo:inline font-family="monospace">1</fo:inline> to <fo:inline font-family="monospace">9223372036854775807</fo:inline> because even on modern computers the program would take longer to run than the age of the universe.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The goal is therefore to run <fo:inline font-family="monospace">mulmod</fo:inline> the fewest times possible. My algorithm is simple: take an iterator of <fo:inline font-family="monospace">2<fo:inline font-size="75%" baseline-shift="super">62</fo:inline></fo:inline> (approximately halfway up the number line) and try the <fo:inline font-family="monospace">mulmod</fo:inline> method. If it returns a negative, backtrack and divide the iterator by two, then try again. Therefore the <fo:inline font-family="monospace">mulmod</fo:inline> method will only be called around a hundred times.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The code follows. It accepts a <fo:inline font-family="monospace">func</fo:inline> argument, and it works with methods which are only explained in future questions.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long find_max_n (String func)
{
	// func accepts paramaters a, b, n
	long a, b, n, jump;
	boolean is_valid;
																			
	jump = (long) 1 &lt;&lt; 62;
																			
	for (n = jump; ; n += jump)
	{
		a = b = n - 1;
																			
		// {{{ is_valid = (n &gt; 0 &amp;&amp; func (a, b, n) &gt;= 0);
		is_valid = n &gt; 0; // check if n itself exceeds Java's capacity
																			
		if (is_valid)
		{
			if (func.equals ("mulmod"))
			{
				is_valid = mulmod (a, b, n) &gt;= 0;
			}
			else if (func.equals ("mulmod_java"))
			{
				is_valid = mulmod_java (a, b, n) &gt;= 0;
			}
			else if (func.equals ("mulmod_with_addmod"))
			{
				is_valid = mulmod_with_addmod (a, b, n) &gt;= 0;
			}
			else if (func.equals ("addmod"))
			{
				is_valid = addmod (a, b, n) &gt;= 0;
			}
			else if (func.equals ("addmod_java"))
			{
				is_valid = addmod_java (a, b, n) &gt;= 0;
			}
			else if (func.equals ("expmod"))
			{
				is_valid = expmod (a, b, n) &gt;= 0;
			}
		}
																			
		// }}} is_valid
																			
		if (is_valid == false)
		{
			n -= jump; // backtrack to last known good value
																			
			jump &gt;&gt;&gt;= 1;
																			
			if (jump == 0) break; // The previous n was indeed the maximum n                                                                                
			// So loop -- add (old jump)/2 to n and try that.
		}
	}
																			
	return n;
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">And so, the answers:</fo:block><fo:list-block id="id2450631" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.5em"><fo:list-item id="id2450633" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>&#x2022;</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block><fo:inline font-family="monospace">mulmod_java</fo:inline> accepts a maximum <fo:inline font-family="monospace">n</fo:inline> of <fo:inline font-family="monospace">3037000500</fo:inline> (<fo:inline font-family="monospace">a</fo:inline> and <fo:inline font-family="monospace">b</fo:inline> are less than the square root of 2<fo:inline font-size="75%" baseline-shift="super">63</fo:inline>).</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="id2450595" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>&#x2022;</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block><fo:inline font-family="monospace">mulmod</fo:inline> accepts a maximum <fo:inline font-family="monospace">n</fo:inline> of <fo:inline font-family="monospace">4611686018427387904</fo:inline> (2<fo:inline font-size="75%" baseline-shift="super">62</fo:inline>).</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block></fo:block><fo:block id="question-3"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">Question 3</fo:marker><fo:block font-size="20.736pt">Question 3</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The question asks for an improvement to the <fo:inline font-family="monospace">addmod_java</fo:inline> shown in <fo:basic-link internal-destination="question-2">the section called &#x201C;Question 2&#x201D;</fo:basic-link>.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The problem with the existing algorithm is that it <fo:inline font-family="monospace">a + b</fo:inline> can exceed the maximum value of a <fo:inline font-family="monospace">long</fo:inline>. Since <fo:inline font-family="monospace">(a + b) % n</fo:inline> can only be equal to either <fo:inline font-family="monospace">a + b - n</fo:inline> or <fo:inline font-family="monospace">a + b</fo:inline>, it is easy to write a special-case algorithm to optimize <fo:inline font-family="monospace">mulmod</fo:inline>.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long addmod (long a, long b, long n)
{
	// assume a &lt; n,  b &lt; n, and all three are positive
																			
	long result = a - n + b;
																			
	if (result &gt;= 0)
	{
		return result;
	}
	else
	{
		return result + n;
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Then, edit <fo:inline font-family="monospace">mulmod</fo:inline> to use <fo:inline font-family="monospace">addmod</fo:inline> in the place of <fo:inline font-family="monospace">addmod_java</fo:inline>.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long mulmod_with_addmod (long a, long b, long n)
{
	long a_doubled;
									
	if (b == 0) return 0; // a * 0 = 0 %n
									
	a_doubled = addmod (a, a, n);
									
	if ((b &amp; 1) == 0)
	{
		// a * b = (2 * a) * (b / 2) % n
		return mulmod_with_addmod (a_doubled,
					   b &gt;&gt;&gt; 1,
					   n);
	}
	else
	{
		// a * b = a + (2 * a) * ((b - 1) / 2) % n
		return addmod (a,
			       mulmod_with_addmod (a_doubled,
						   b &gt;&gt;&gt; 1,
						   n),
			       n);
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">This simple algorithm also speeds up the <fo:inline font-family="monospace">mulmod</fo:inline> somewhat, since it replaces a costly mod operation with a comparison and two or three additions.</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The algorithm now extends to the maximum positive value of a <fo:inline font-family="monospace">long</fo:inline> integer: that is, <fo:inline font-family="monospace">n = 9223372036854775807</fo:inline>.</fo:block></fo:block><fo:block id="question-4"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">Question 4</fo:marker><fo:block font-size="20.736pt">Question 4</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The <fo:inline font-family="monospace">expmod</fo:inline> method is even <fo:inline font-style="italic">easier</fo:inline> to write than the <fo:inline font-family="monospace">mulmod</fo:inline> method, since it's basically all written already. It just needs a few replacements.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public static long expmod (long a, long b, long n)
{
	long a_squared;
									
	if (b == 0) return 1; // a ^ n = 1 % n
									
	a_squared = mulmod_with_addmod (a, a, n);
									
	if ((b &amp; 1) == 0)
	{
		// a ^ b = (a ^ 2) ^ (b / 2)
		return expmod (a_squared, b &gt;&gt;&gt; 1, n);
	}
	else
	{
		// a ^ b = a * (a ^ 2) ^ ((b - 1) / 2)
		return mulmod_with_addmod (a,
					   expmod (a_squared,
						   b &gt;&gt;&gt; 1,
						   n),
					   n);
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Given <fo:inline font-family="monospace">a</fo:inline> = <fo:inline font-family="monospace">1274434408442</fo:inline>, <fo:inline font-family="monospace">b</fo:inline> = <fo:inline font-family="monospace">589394265617</fo:inline>, and <fo:inline font-family="monospace">n</fo:inline> = <fo:inline font-family="monospace">1606818609763</fo:inline>, the resultant (<fo:inline font-family="monospace">c</fo:inline>) is <fo:inline font-family="monospace">308250308250</fo:inline> (notice the pattern in the digits: it's our course number repeated twice). Calling the method again with given parameters <fo:inline font-family="monospace">308250308250</fo:inline> (<fo:inline font-family="monospace">c</fo:inline>), <fo:inline font-family="monospace">433371342353</fo:inline> (<fo:inline font-family="monospace">d</fo:inline>), and <fo:inline font-family="monospace">1606818609763</fo:inline> (<fo:inline font-family="monospace">n</fo:inline>) gives the answer <fo:inline font-family="monospace">1274434408442</fo:inline> (this number is actually <fo:inline font-family="monospace">a</fo:inline> from above).</fo:block></fo:block><fo:block id="code"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">Code</fo:marker><fo:block font-size="20.736pt">Code</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block id="id2449844"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">basis.java</fo:marker><fo:block font-size="17.28pt"><fo:inline font-family="monospace">basis.java</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">All program listings from the preceding sections were placed in the file <fo:basic-link external-destination="url(../basis.java)">../basis.java</fo:basic-link>. Each of the following classes extends the <fo:inline font-family="monospace">basis</fo:inline> class, adding a front-end.</fo:block></fo:block><fo:block id="id2449867"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">q1.java</fo:marker><fo:block font-size="17.28pt"><fo:inline font-family="monospace">q1.java</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public class q1 extends basis
{
	public static void main(String[] argv)
	{
		long a, b;

		if (argv.length != 2)
		{
			System.err.println ("usage: q1 [multiplier]"+
					    " [multiplicand]");
			return;
		}

		a = Long.parseLong (argv[0]);
		b = Long.parseLong (argv[1]);

		System.out.println (a + " * " + b + " = " +
				    mulalarusse (a, b));
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The program in <fo:basic-link external-destination="url(../q1.java)">../q1.java</fo:basic-link> is a simple program to multiply two numbers. It requires two arguments, representing the two (<fo:inline font-family="monospace">long</fo:inline>) numbers to be multiplied. For example:</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace"><fo:inline font-family="monospace">$ </fo:inline><fo:inline font-weight="bold" font-family="monospace">java q1 35 -143</fo:inline>
<fo:inline font-family="monospace">35 * -143 = -5005</fo:inline></fo:block></fo:block><fo:block id="id2449924"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">q2.java</fo:marker><fo:block font-size="17.28pt"><fo:inline font-family="monospace">q2.java</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public class q2 extends basis
{
	public static void main(String[] argv)
	{
		long n;

		if (argv.length != 1)
		{
			System.err.println ("usage: q2 [-m] [-j] [-a]");
			return;
		}

		if (argv[0].equals ("-m"))
		{
			n = find_max_n ("mulmod");
			System.out.println ("Largest value of n with"
					    + " mulmod: " + n);
			return;
		}

		if (argv[0].equals ("-j"))
		{
			n = find_max_n ("mulmod_java");
			System.out.println ("Largest value of n with"
					    + " mulmod_java: " + n);
			return;
		}

		if (argv[0].equals ("-a"))
		{
			n = find_max_n ("mulmod_with_addmod");
			System.out.println ("Largest value of n with"
					    + " mulmod_with_addmod: " + n);
			return;
		}

		System.err.println ("usage: q2 [-m] [-j] [-a]");
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The program in <fo:basic-link external-destination="url(../q2.java)">../q2.java</fo:basic-link> finds the maximum valid <fo:inline font-family="monospace">n</fo:inline>, as described in <fo:basic-link internal-destination="question-2">the section called &#x201C;Question 2&#x201D;</fo:basic-link>. If called with the <fo:inline font-family="monospace">-m</fo:inline> argument, it will test the <fo:inline font-family="monospace">mulmod</fo:inline> method. If called with the <fo:inline font-family="monospace">-j</fo:inline> argument, it will test the <fo:inline font-family="monospace">mulmod_java</fo:inline> method. If called with the <fo:inline font-family="monospace">-a</fo:inline> method, it will test the <fo:inline font-family="monospace">mulmod_with_addmod</fo:inline> method from <fo:basic-link internal-destination="question-3">the section called &#x201C;Question 3&#x201D;</fo:basic-link>. For example:</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace"><fo:inline font-family="monospace">$ </fo:inline><fo:inline font-weight="bold" font-family="monospace">java q2 -j</fo:inline>
<fo:inline font-family="monospace">Largest value of n with mulmod_java: 3037000500</fo:inline>
<fo:inline font-family="monospace">$ </fo:inline><fo:inline font-weight="bold" font-family="monospace">java q2 -m</fo:inline>
<fo:inline font-family="monospace">Largest value of n with mulmod: 4611686018427387904</fo:inline>
<fo:inline font-family="monospace">$ </fo:inline><fo:inline font-weight="bold" font-family="monospace">java q2 -a</fo:inline>
<fo:inline font-family="monospace">Largest value of n with mulmod_with_addmod: 9223372036854775807</fo:inline></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Note that this program covers both <fo:basic-link internal-destination="question-2">the section called &#x201C;Question 2&#x201D;</fo:basic-link> and <fo:basic-link internal-destination="question-3">the section called &#x201C;Question 3&#x201D;</fo:basic-link>.</fo:block></fo:block><fo:block id="id2450071"><fo:block><fo:block><fo:block keep-together="always" margin-left="-4pc" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em"><fo:marker marker-class-name="section.head.marker">q4.java</fo:marker><fo:block font-size="17.28pt"><fo:inline font-family="monospace">q4.java</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block/></fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace">public class q4 extends basis
{
	public static void main (String[] argv)
	{
		long a, b, c, d, e, n;

		a = 1274434408442L;
		b = 589394265617L;
		n = 1606818609763L;

		System.out.println ("a: " + a);
		System.out.println ("b: " + b);
		System.out.println ("n: " + n);

		System.out.println ("c = (a ^ b) % n");
		c = expmod (a, b, n);
		System.out.println ("c: " + c);

		d = 433371342353L;

		System.out.println ("d: " + d);

		System.out.println ("e = (c ^ d) % n");
		e = expmod (c, d, n);
		System.out.println ("e: " + e);
	}
}</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The program in <fo:basic-link external-destination="url(../q4.java)">../q4.java</fo:basic-link> goes through the question and prints its progress.</fo:block><fo:block wrap-option="no-wrap" white-space-collapse="false" linefeed-treatment="preserve" text-align="start" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" font-family="monospace"><fo:inline font-family="monospace">$ </fo:inline><fo:inline font-weight="bold" font-family="monospace">java q4</fo:inline>
<fo:inline font-family="monospace">a: 1274434408442
b: 589394265617
n: 1606818609763
c = (a ^ b) % n
c: 308250308250
d: 433371342353
e = (c ^ d) % n
e: 1274434408442</fo:inline>
</fo:block></fo:block></fo:block></fo:flow></fo:page-sequence></fo:root>
